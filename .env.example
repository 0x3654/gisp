## telegram notification (раскомментируйте при необходимости)
# BOT_TOKEN=XXXXXXXXXX:YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
# CHAT_ID=NNNNNNNN
REGISTRY_NODE_NAME=registry-node-1 # подпись сервера в уведомлениях (опционально)
# default parameters
# base
POSTGRES_HOST=postgres_registry
POSTGRES_PORT=5432
POSTGRES_USER=registry
POSTGRES_PASSWORD=registry
POSTGRES_DB=registry
PGDATA=/var/lib/postgresql/data/pgdata
TZ=Europe/Moscow
PG_AUTOPREWARM_INTERVAL=120

# api service
REESTR_MIN_LIMIT=1
REESTR_DEFAULT_LIMIT=20
REESTR_MAX_LIMIT=200
REESTR_MIN_OFFSET=0
REESTR_DEFAULT_OFFSET=0
# semantic service
# Оптимальный образ выбирается автоматически по архитектуре хоста:
# - ONNX (рекомендуется): быстрее и компактнее на обеих архитектурах
#   - AMD64: ~1.03GB, 27-32ms (на 36% быстрее чем Python 3.10)
#   - ARM64: ~1.69GB, 37-44ms (в 3+ раза быстрее чем PyTorch)
# - PyTorch (альтернатива): доступен но медленнее на ARM64
#   - AMD64: ~1.93GB, 28-35ms
#   - ARM64: ~2.46GB, 104-186ms (не рекомендуется)
# Python 3.12 с pymorphy3 (современный стек)
# Для переключения на PyTorch измените image в compose.yaml
SEMANTIC_URL=http://semantic:8010/semantic_normalize
SEMANTIC_CACHE_TTL_SECONDS=604800 # 7 дней
SEMANTIC_FORCE_SEQSCAN=0 # оставьте 1 только если нужно отключить index scan
# import
FILES_DIR=/files
START_DATE=2024-09-05
BASE_URL=https://minpromtorg.gov.ru/opendata/1000000012-ReestrProducts/data-{date}-structure-20210405.csv
LOG_DIR=/var/log/registry
MAX_CSV_FILES=7
MAX_LOG_FILES=7
MAX_MAINTENANCE_LOG_FILES=7
AUTO_EMBED=1 # установите 0, чтобы импорт не пересчитывал эмбеддинги (пересчитайте позже воркером)
STARTER_FORCE=0 # 1 — перезаписать данные при запуске starter-dump

# ===================================
# DOCKER COMPOSE INFRASTRUCTURE
# ===================================

# Ports
POSTGRES_PORT=5432
API_PORT=8000
SEMANTIC_PORT=8010
OPENWEBUI_PORT=3333

# PostgreSQL tuning
PG_SHM_SIZE=2g

# Semantic service
SEMANTIC_WORKERS=2

# Import cron schedules (minute hour day month dow, uses $TZ)
CRON_IMPORT_SCHEDULE=5 0 * * *
CRON_MAINTENANCE_SCHEDULE=0 5 * * *

# Starter service
STARTER_MAX_WAIT=180

# Embeddings worker
EMBEDDINGS_BATCH_SIZE=200
EMBEDDINGS_SHARD_INDEX=0
EMBEDDINGS_SHARD_COUNT=1

# Worker flags
FORCE=0
DRY_RUN=0
SOURCE_FILES=
EMBED_IDS=
LIMIT=
EXTRA_EMBED_ARGS=
SEMANTIC_URL_OVERRIDE=

# Watchtower (auto-update)
WATCHTOWER_ENABLE=false
WATCHTOWER_SCOPE=
WATCHTOWER_SCHEDULE=0 0 * * *
